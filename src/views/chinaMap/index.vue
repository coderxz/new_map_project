<template>
  <div>
    <div style="display: flex">
      <div v-for="(item, index) in mapList" :key="index" class="nihaox" style="color:#fff;z-index: 1;position: relative;" @click="cityMapXs(item)">
        <span class="tdsx">{{ item.name }}</span>
        <span v-show="index + 1 !== mapList.length" class="icon">=></span>
      </div>
    </div>
    <div class="map-wrap">
      <div class="logo"></div>
      <div class="time">
        <div class="tt">{{ hms }}</div>
        <div class="day">
          <div class="rz">{{ MM.indexOf('0') === -1 ? MM : MM.slice(1, 2) }}月{{ DD }}日</div>
          <div class="year">{{ year || '2021' }}</div>
        </div>
        <div class="city">{{ cityName || '浙江省' }}</div>
      </div>
      <div id="city" :style="{ transform: `scale(${Style().scale})`, top: Style().top + 'rem' }" :class="[mapShow ? 'showMap' : 'showMapNot']"></div>
      <div :class="{ chanzhe: isShow1 }" class="citywraper">
        <div :class="[isShow8 ? 'mask' : 'mask1']"></div>
        <div class="cityName">{{ cityName || '浙江省' }}</div>
        <div class="quyu">
          <img :src="imagesURL" alt="" class="imgPosition" @click="nihao" />
          <div class="Dot"></div>
          <div :class="{ xian1Animation: isShow }" class="xian1 noshow"></div>
          <div :class="{ xian2Animation: isShow }" class="xian2 noshow"></div>
          <div :class="{ xian3Animation: isShow }" class="xian3 noshow"></div>
          <div :class="{ xian4Animation: isShow }" class="xian4 noshow"></div>
        </div>
      </div>
      <div class="tableWrap">
        <!-- 表1 -->
        <div :class="{ isopacity: isShow7 }" class="pie-box">
          <div class="header-tab">
            <!-- <div :class="{ topstyle: isShow }" class="top " @click="changeHeightL">会员数</div>
          <div class="top" :class="{ topstyle: isShow }">订单数</div>
          <div class="top">订单额</div>
          <div class="top">收益</div> -->
            <div
              v-for="(item, index) in piedata1"
              :key="index"
              :class="{ topstyle: isHighlight1 === index }"
              class="top"
              @click="changeHighlight1(index)"
            >
              {{ item.name }}
            </div>
          </div>
          <!-- 饼状图 -->
          <div class="circle-bg">
            <div ref="pie1" class="circle"></div>
          </div>
          <div class="pie-bg2">总数</div>
          <div class="pie-bg3">6,827,100,815</div>
        </div>
        <!-- 表2 -->
        <div :class="{ isopacity: isShow7 }" class="pie-box2">
          <div class="header-tab">
            <div
              v-for="(item, index) in piedata2"
              :key="index"
              :class="{ topstyle: isHighlight2 === index }"
              class="top"
              @click="changeHighlight2(index)"
            >
              {{ item.name }}
            </div>
          </div>
          <div class="circle-bg">
            <div ref="pie2" class="circle2"></div>
          </div>
        </div>
        <!-- 表3 -->
        <div :class="{ isopacity: isShow7 }" class="histogram-week">
          <div class="header-tab">
            <div
              v-for="(item, index) in bardata"
              :key="index"
              :class="{ topstyle: isHighlight3 === index }"
              class="top"
              @click="changeHighlight3(index)"
            >
              {{ item.name }}
            </div>
          </div>
          <div class="histogram-bg">
            <div ref="bar" class="histogram"></div>
          </div>
        </div>
        <!-- VIP -->
        <div class="vip-box">
          <div :class="{ show: isShow4 }" class="o-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="c-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="n-yuan noshow"></div>
          <!--图标-->
          <div class="tb-logo">
            <img :class="{ show: isShow3 }" src="../../assets/images/people.png" alt="" class="noshow" />
          </div>
          <!--线条-->
          <img :class="{ widthto99: isShow2 }" src="../../assets/images/position-tiao.png" alt="" class="cz-png " />

          <img :class="{ widthto98: isShow2 }" src="../../assets/images/xian.png" alt="" class="p-xian " />

          <!--会员数-->
          <div id="vip" :class="{ show: isShow6 }" class="vip-number">6827100815</div>

          <div :class="{ textani: isShow5 }" class="vip-tit">
            <p class="p1">会员数</p>
            <p>Members</p>
          </div>
        </div>
        <!--消费订单-->
        <div class="consume-box">
          <!--三圆动画-->
          <div :class="{ show: isShow4 }" class="o-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="c-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="n-yuan noshow"></div>
          <!--图标-->
          <div class="tb-logo">
            <img :class="{ show: isShow3 }" src="../../assets/images/shop.png" alt="" class="noshow" />
          </div>
          <!--线条-->
          <img :class="{ widthto99: isShow2 }" src="../../assets/images/position-tiao.png" alt="" class="cz-png" />

          <img :class="{ widthto98: isShow2 }" src="../../assets/images/xian.png" alt="" class="p-xian" />

          <!--会员数-->
          <div id="consume" :class="{ show: isShow6 }" class="vip-number">5665157496</div>

          <div :class="{ textani: isShow5 }" class="vip-tit">
            <p class="p1">消费订单</p>
            <p>Consumer orders</p>
          </div>
        </div>
        <!--订单交易额-->
        <div class="Order-volume">
          <!--三圆动画-->
          <div :class="{ show: isShow4 }" class="bo-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="bc-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="bn-yuan noshow">
            <div class="quchu"></div>
          </div>
          <!--图标-->
          <div class="tb-logo">
            <img :class="{ show: isShow3 }" src="../../assets/images/money.png" alt="" class="noshow" />
          </div>
          <!--线条-->
          <img :class="{ widthto99: isShow2 }" src="../../assets/images/position-tiao-b.png" alt="" class="cz-png" />

          <img :class="{ widthto98: isShow2 }" src="../../assets/images/xian-b.png" alt="" class="p-xian" />

          <!--会员数-->
          <div id="Order-volume" :class="{ show: isShow6 }" class="vip-number">4387662</div>

          <div :class="{ textani1: isShow5 }" class="vip-tit">
            <p class="p1">订单交易额</p>
            <p>Order volume</p>
          </div>
        </div>
        <!--地区收益-->
        <div class="region-box">
          <!--三圆动画-->
          <div :class="{ show: isShow4 }" class="bo-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="bc-yuan noshow"></div>
          <div :class="{ show: isShow4 }" class="bn-yuan noshow"></div>
          <!--图标-->
          <div class="tb-logo">
            <img :class="{ show: isShow3 }" src="../../assets/images/purse.png" alt="" class="noshow" />
          </div>
          <!--线条-->
          <img :class="{ widthto99: isShow2 }" src="../../assets/images/position-tiao-b.png" alt="" class="cz-png" />

          <img :class="{ widthto98: isShow2 }" src="../../assets/images/xian-b.png" alt="" class="p-xian" />

          <!--会员数-->
          <div id="region" :class="{ show: isShow6 }" class="vip-number">4387662</div>

          <div :class="{ textani1: isShow5 }" class="vip-tit">
            <p class="p1">地区收益</p>
            <p>Our income</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
// import MapCofig from '../../utils/Maputils';
import '../../assets/js/jquery.min.js';
import '../../assets/js/circle-progress';
import '../../assets/js/wy_rem';
import { CountUp } from '../../assets/js/countUp';
// import axios from 'axios';
import imagesURL from '../../assets/images/province1.png';
import guangdong from '../../assets/images/guangdong.png';
let that;
// var extendOptions;
let activeInstance = null; //记录你点击上层是啥 东西 方便操作
let prevActiveInstance = null;
function debounce(func, wait = 1000) {
  //可以放入项目中的公共方法中进行调用（鹅只是省事）
  let timeout;
  return function(event) {
    clearTimeout(timeout);
    timeout = setTimeout(() => {
      func.call(this, event);
    }, wait);
  };
}
export default {
  name: 'Nihao',
  data() {
    return {
      isShow8: false,
      isShow7: false,
      isShow6: false,
      isShow5: false,
      isShow3: false,
      isShow4: false,
      isShow2: false,
      isShow1: false,
      isShow: false,
      mapShow: false,
      FlyLine: false,
      Drilldown: false,
      imagesURL,
      piedata1: [
        {
          name: '会员',
        },
        {
          name: '订单',
        },
        {
          name: '订单额',
        },
        {
          name: '收益',
        },
      ],
      piedata2: [
        {
          name: '消费金额来源',
        },
        {
          name: '消费次数来源',
        },
      ],
      bardata: [
        {
          name: '会员数',
        },
        {
          name: '订单数',
        },
        {
          name: '订单额',
        },
        {
          name: '收益',
        },
      ],
      dom: null,
      timer: null,
      chake: false,
      NamexS: '',
      isxianshow: false,
      cityName: '',
      year: '',
      MM: '',
      DD: '',
      pack: '',
      hms: this.$moment().format('HH:mm:ss'),
      isHighlight1: 0,
      isHighlight2: 0,
      isHighlight3: 0,
      mapList: [
        {
          name: '全国',
          key: 'china',
        },
      ], //返回栏的默认
      cityCodeArr: [], //默认是那个参数进来
      geoJson: {
        //处理json返回的格式
        features: [],
      },
      cacheCode: 0, //缓存的key
      cachedCtors: {}, //存放的对象
      topSclaeConfig: {
        //对地图层级的 top 和 scale的 参数配置
        '1': {
          top: '-0.72',
          scale: '0.9',
        },
        '2': {
          top: '0.15',
          scale: '0.7',
        },
        '3': {
          top: '0.15',
          scale: '0.7',
        },
      },
      restoreActiveInstance: null,
    };
  },
  computed: {
    Style() {
      return () => {
        return this.topSclaeConfig[this.mapList.length];
      };
    },
  },
  created() {
    that = this;
    this.getTimer();
  },
  mounted() {
    // 输入：nums = [2,11,7,15], target = 9
    // 输出：[0,1]
    // 解释：因为 nums[0] + nums[1] == 9 ，返回 [0, 1] 。
    // 输入：nums = [3,2,4], target = 6
    // 输出：[1,2]
    // 输入：nums = [3,3], target = 6
    // 输出：[0,1]
    //  [3,2,3]
    //   6
    var twoSum = function(nums, target) {};
    console.log(twoSum([3, 2, 3], 6));
    that.restoreActiveInstance = that.setActiveInstance({
      name: '全国',
      key: 'china',
    });
    window.addEventListener('resize', this.res);
    // ////console.log
    //console.log(activeInstance, '初始化');
    //console.log(prevActiveInstance, '初始化');
    // restoreActiveInstance()
    // extendOptions = extendOptions || {};
    // that.cachedCtors = extendOptions._Ctor || (extendOptions._Ctor = {});
    ////console.log(document.documentElement);
    this.timer = setInterval(() => {
      this.year = this.$moment().format('YYYY');
      this.MM = this.$moment().format('MM');
      this.DD = this.$moment().format('DD');
      this.hms = this.$moment().format('HH:mm:ss');
    }, 1000);
    this.demo();
    this.createMychart1();
    this.createMychart2();
    this.createMychart3();
    //////console.log(MapCofig,'配置')
    that.$nextTick(async () => {
      that.dom = document.getElementById('city');
      that.myChart = that.$echarts.init(that.dom);
      that.runMapOption('浙江省', 'china');
      that.myChart.on('click', async params => {
        if (params.seriesType === 'map') {
          this.isShow8 = true;
          this.clearTimer();
          this.setAnimationTimer();
          switch (params.name) {
            case '内蒙古自治区':
              params.name = '内蒙古';
              break;
            case '西藏自治区':
              params.name = '西藏';
              break;
            case '新疆维吾尔自治区':
              params.name = '新疆';
              break;
            case '宁夏回族自治区':
              params.name = '宁夏';
              break;
            case '广西壮族自治区':
              params.name = '广西';
              break;
            case '香港特别行政区':
              params.name = '香港';
              break;
            case '澳门特别行政区':
              params.name = '澳门';
              break;
            default:
              break;
          }
          this.params = params;
          this.cityName = params.name;
          if (that.mapList.length > 3) {
            this.FlyLine = false;
            return;
          }
          this.FlyLine = true;
          if (params.name === '广东省') {
            this.imagesURL = guangdong;
          }
          event.stopPropagation();
          //
          that.runMapOption(params.data.name, []);
          this.option1.series[0].data[0].name = this.cityName;
          //
          this.myChart1.setOption(this.option1);
          this.createMychart2();
          this.createMychart3();
        }
      });
    });
  },
  beforeMount() {
    // 设置防抖方法(周期内按下多次只会执行最后一次)
    // 注意: 这里只需要传入函数就行了(不用写括号参数,写了就是执行)
    this.debounceHandleValuesChange = debounce(this.showProvince, 300);
  },
  methods: {
    // 召哥 弄的 time 5月27日 开始
    // 清除动画定时器

    clearTimer() {
      let arr = ['isShow', 'isShow1', 'isShow2', 'isShow3', 'isShow4', 'isShow5', 'isShow6', 'isShow7'];
      arr.forEach(item => {
        that[item] = false;
      });
      clearTimeout(this.timer1);
      this.timer1 = null;
      clearTimeout(this.timer2);
      this.timer2 = null;
      clearTimeout(this.timer3);
      this.timer3 = null;
      clearTimeout(this.timer4);
      this.timer4 = null;
      clearTimeout(this.timer5);
      this.timer5 = null;
      clearTimeout(this.timer6);
      this.timer6 = null;
      clearTimeout(this.timer7);
      this.timer7 = null;
    },
    setAnimationTimer() {
      //控制小地图的显示+右侧图标显示
      this.timer1 = setTimeout(() => {
        this.isShow1 = true;
        this.isShow7 = true;
      }, 2000);
      //控制四条线
      this.timer2 = setTimeout(() => {
        this.isShow = true;
      }, 3000);
      //控制头像
      this.timer3 = setTimeout(() => {
        this.isShow3 = true;
      }, 4500);
      //控制画圆
      this.timer4 = setTimeout(() => {
        this.isShow4 = true;
        this.demo();
      }, 5000);
      //控制上下两张图片
      this.timer5 = setTimeout(() => {
        this.isShow2 = true;
      }, 6000);
      // 文字动画
      this.timer6 = setTimeout(() => {
        setTimeout(() => {
          this.isShow8 = false;
        }, 1500);
        this.isShow5 = true;
      }, 7000);
      //数字动画
      this.timer7 = setTimeout(() => {
        this.isShow6 = true;
        this.numberAnimation();
      }, 7000);
    },
    numberAnimation() {
      var options = {
        useEasing: true,
        useGrouping: true,
        separator: ',',
        decimal: '.',
      };
      //目标= html元素id,输入,svg文本元素,或之前选定元素的var /输入计数发生的地方
      //startVal =你想开始的价值
      //endVal =你想要到达的价值
      //小数=(可选)的小数位数号码,默认为0
      //时间=(可选)持续时间以秒为单位,默认2
      //选择=(看演示,可选)格式/宽松的选择对象
      // debugger;
      var vip = new CountUp('vip', 0, 6827100815, 0, 1.5, options);
      var consume = new CountUp('consume', 0, 5665157496, 0, 1.5, options);
      var OrderVolume = new CountUp('Order-volume', 0, 4387662, 0, 1.5, options);
      var region = new CountUp('region', 0, 14587348, 0, 1.5, options);
      var pienumeber = new CountUp('pie-bg3', 0, 6827100815, 0, 1.5, options);
      if (!vip.error) {
        vip.start();
        consume.start();
        OrderVolume.start();
        region.start();
        pienumeber.start();
      } else {
        console.error(vip.error);
      }
    },
    getTimer() {
      this.year = this.$moment().format('YYYY');
      this.MM = this.$moment().format('MM');
      this.DD = this.$moment().format('DD');
      this.hms = this.$moment().format('HH:mm:ss');
      // 表1配置
      this.option1 = {
        title: {
          text: '所占比例',
          top: '5%',
          left: 'left',
          textStyle: {
            fontSize: 15,
            fontWeight: 'bolder',
            color: '#f3c800',
          },
        },
        tooltip: {
          trigger: 'item',
          formatter: '{a} <br/>{b} : {c} ({d}%)',
        },
        legend: {
          x: 'right',
          y: 'bottom',
          orient: 'vertical',
          textStyle: {
            fontWeight: 'bolder',
            color: '#fff',
          },
        },
        series: [
          {
            name: '会员数',
            type: 'pie',
            radius: ['40%', '70%'],
            avoidLabelOverlap: false,
            label: {
              show: true,
              position: 'outside',
              fontSize: 16,
              formatter: val => {
                // if (val.data.name === '该省') {
                //   return val.data.value / 100 + '%';
                // } else {
                //   return `${val.data.name}
                //           ${val.data.value / 100}%`;
                // }
                // ////console.log(val.data.value);
                return `${val.data.name}\r\n${val.data.value / 100}%`;
              },
            },
            itemStyle: {
              color: function(params) {
                //自定义颜色
                var colorList = ['#f3c800', '#00c6f7'];
                return colorList[params.dataIndex];
              },
            },
            emphasis: {
              itemStyle: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: 'rgba(0, 0, 0, 0.5)',
              },
            },
            labelLine: {
              show: false,
            },
            data: [
              { value: 2500, name: that.cityName || '浙江' },
              { value: 7500, name: '全国' },
            ],
            height: '100%',
          },
        ],
      };
      //表2配置
      this.option2 = {
        // 标题
        title: {
          text: '所占比例',
          top: '5%',
          left: 'left',
          textStyle: {
            fontSize: 15,
            fontWeight: 'bolder',
            color: '#f3c800',
          },
        },
        legend: {
          x: 'right',
          y: 'bottom',
          orient: 'vertical',
          textStyle: {
            fontWeight: 'bolder',
            color: '#fff',
          },
        },
        series: [
          {
            name: '消费金额来源',
            type: 'pie',
            avoidLabelOverlap: true,
            itemStyle: {
              color: function(params) {
                //自定义颜色
                var colorList = ['#f3c800', '#00c6f7', '#00ffde'];
                return colorList[params.dataIndex];
              },
            },
            label: {
              position: 'inside',
              formatter: val => {
                return `${val.data.value / 100}%`;
              },
            },
            emphasis: {
              itemStyle: {
                shadowBlur: 10,
                shadowOffsetX: 0,
                shadowColor: 'rgba(0, 0, 0, 0.5)',
              },
            },
            labelLine: {
              show: false,
            },
            //表格数据
            data: [
              { value: 2600, name: '本省去他省消费金额' },
              { value: 3800, name: '他省去本省消费金额' },
              { value: 3600, name: '本省消费金额' },
            ],
            height: '75%',
          },
        ],
      };
      //表3配置
      this.option3 = {
        //标题
        title: {
          text: '近期收益金额',
          top: '5%',
          left: 'left',
          textStyle: {
            fontSize: 15,
            fontWeight: 'bolder',
            color: '#f3c800',
          },
        },
        //自定义item项颜色
        itemStyle: {
          color: function(params) {
            //自定义颜色
            var colorList = ['#00c6f7', '#00c6f7', '#00c6f7', '#00c6f7', '#00c6f7', '#00c6f7', '#00c6f7'];
            return colorList[params.dataIndex];
          },
        },
        textStyle: {
          fontSize: 15,
          color: '#fff',
        },
        axisTick: {
          show: false,
        },
        grid: {
          color: '#fff',
        },
        xAxis: {
          type: 'category',
          data: ['周一', '周二', '周三', '周四', '周五', '周六', '周日'],
          axisTick: {
            show: false,
          },
        },
        yAxis: {
          show: false,
          type: 'value',
          axisTick: {
            show: false,
          },
        },
        series: [
          {
            data: [80, 110, 90, 150, 290, 222, 430],
            type: 'bar',
          },
        ],
      };
    },
    nihao() {
      that.debounceHandleValuesChange();
    },
    showProvince() {
      this.Drilldown = true;
      if (that.mapList.length >= 3) {
        this.FlyLine = false;
        return;
      }
      if (this.FlyLine && this.Drilldown) {
        that.clearTimer();
        this.Drilldown = false;
        this.mapShow = true;
        setTimeout(() => {
          that.myChart.clear();
          that.mapList.push({ name: this.params.data.name, key: this.params.data.cityCode });
          that.setActiveInstance({ name: this.params.data.name, key: this.params.data.cityCode });
          that.mapShow = false;
          that.runMapOption(this.params.data.name, [this.params.data.cityCode]);
        }, 1800);
      }
    },
    demo() {
      //
      $('.o-yuan').circleProgress({
        value: 0.75,
        size: 90,
        startAngle: -15,
        fill: {
          gradient: ['#00ddf7'],
        },
      });
      // eslint-disable-next-line no-undef
      $('.c-yuan').circleProgress({
        value: 1,
        size: 65,
        startAngle: -15,
        thickness: 3,
        fill: {
          gradient: ['#00ddf7'],
        },
      });
      $('.n-yuan').circleProgress({
        value: 1,
        size: 50,
        startAngle: -15,
        thickness: 5,
        fill: {
          gradient: ['#00ddf7'],
        },
      });
      $('.bo-yuan').circleProgress({
        //底部上来弧度95
        value: 0.75,
        size: 90,
        startAngle: -0.8,
        reverse: true,
        fill: {
          gradient: ['#00ddf7'],
        },
      });
      $('.bc-yuan').circleProgress({
        value: 1,
        size: 65,
        startAngle: -0.8,
        thickness: 3,
        reverse: true,
        fill: {
          gradient: ['#00ddf7'],
        },
      });
      $('.bn-yuan').circleProgress({
        value: 1,
        size: 50,
        startAngle: -0.8,
        thickness: 5,
        reverse: true,
        fill: {
          gradient: ['#00ddf7'],
        },
      });
    },
    changeHighlight1(index) {
      this.isHighlight1 = index;
      switch (index) {
        case 0:
          ////console.log('会员');
          this.createMychart1('会员');
          break;
        case 1:
          ////console.log('订单');
          this.createMychart1('订单');
          break;
        case 2:
          ////console.log('订单额');
          this.createMychart1('订单额');
          break;
        case 3:
          ////console.log('收益');
          this.createMychart1('收益');
          break;
      }
    },
    changeHighlight2(index) {
      this.isHighlight2 = index;
      switch (index) {
        case 0:
          ////console.log('消费金额来源');
          this.createMychart2('消费金额来源');
          break;
        case 1:
          ////console.log('消费次数来源');
          this.createMychart2('消费次数来源');
          break;
      }
    },
    changeHighlight3(index) {
      this.isHighlight3 = index;
      switch (index) {
        case 0:
          ////console.log('会员数');
          this.createMychart3('会员数');
          break;
        case 1:
          ////console.log('订单数');
          this.createMychart3('订单数');
          break;
        case 2:
          ////console.log('订单额');
          this.createMychart3('订单额');
          break;
        case 3:
          ////console.log('收益');
          this.createMychart3('收益');
          break;
      }
    },
    createMychart1(name) {
      //
      // let chartDom = this.$refs.pie1;
      this.$refs.pie1.setAttribute('_echarts_instance_', '');
      this.option1.series[0].name = name;
      this.myChart1 = this.$echarts.init(this.$refs.pie1);
      // ////console.log(chartDom, this.$refs.pie1);
      this.option1 && this.myChart1.setOption(this.option1, true);
    },
    createMychart2(name) {
      //
      // let chartDom = this.$refs.pie1;
      this.$refs.pie2.setAttribute('_echarts_instance_', '');
      // this.option1.series[0].name = name;
      this.option2.series[0].name = name;
      this.myChart2 = this.$echarts.init(this.$refs.pie2);
      // ////console.log(chartDom, this.$refs.pie1);
      this.option2 && this.myChart2.setOption(this.option2, true);
    },
    createMychart3(name) {
      //
      // let chartDom = this.$refs.pie1;
      this.$refs.bar.setAttribute('_echarts_instance_', '');
      this.myChart3 = this.$echarts.init(this.$refs.bar);
      // ////console.log(chartDom, this.$refs.pie1);
      this.option3 && this.myChart3.setOption(this.option3, true);
    },
    //结束 召哥 TIME 5/27
    //BY JY TIME 2021-5/27
    randomConfiguration(proviceName, nextArray, mapData, cityCode, geoCoordsMap) {
      let series = [];
      // ////console.log
      return new Promise((resolve, reject) => {
        [[proviceName, nextArray]].forEach(function(item, i) {
          series.push(
            {
              type: 'map',
              roam: false,
              label: {
                normal: {
                  formatter: p => {
                    switch (p.name) {
                      case '内蒙古自治区':
                        p.name = '内蒙古';
                        break;
                      case '西藏自治区':
                        p.name = '西藏';
                        break;
                      case '新疆维吾尔自治区':
                        p.name = '新疆';
                        break;
                      case '宁夏回族自治区':
                        p.name = '宁夏';
                        break;
                      case '广西壮族自治区':
                        p.name = '广西';
                        break;
                      case '香港特别行政区':
                        p.name = '香港';
                        break;
                      case '澳门特别行政区':
                        p.name = '澳门';
                        break;
                      default:
                        break;
                    }
                    return p.name;
                  },
                  //是否显示各省分
                  show: true,
                  textStyle: {
                    //省标题的颜色
                    color: '#fff',
                    fontSize: '18',
                  },
                },
                emphasis: {
                  textStyle: {
                    //高亮下省标题的颜色
                    color: '#f75a00',
                    borderWidth: 2,
                    shadowBlur: 18,
                  },
                },
              },
              itemStyle: {
                normal: {
                  borderColor: '#53D9FF', //线的颜色
                  // 线的宽度
                  borderWidth: 1,
                  // 地图颜色
                  areaColor: '#051931',
                  shadowColor: 'rgb(58,115,192)',
                  // 阴影
                  shadowBlur: 8,
                },
                emphasis: {
                  areaColor: 'rgb(46,229,206)',
                  shadowColor: 'rgb(12,25,50)',
                  borderWidth: 1.4,
                },
              },
              zoom: 1.1,
              map: cityCode,
              data: mapData,
            },
            {
              type: 'lines',
              // animation: false,
              animationEasing: 'cubicOut',
              zlevel: 1,
              effect: {
                show: true,
                period: 4, //箭头指向速度，值越小速度越快
                trailLength: 0.4, //特效尾迹长度[0,1]值越大，尾迹越长重
                symbol: 'arrow', //箭头图标
                symbolSize: 7, //图标大小
              },
              lineStyle: {
                normal: {
                  color: '#1DE9B6',
                  width: 1.5, //线条宽度
                  opacity: 0.5, //尾迹线条透明度
                  curveness: 0.3, //尾迹线条曲直度
                },
              },
              data: that.convertData(item[1], geoCoordsMap),
            },
            {
              type: 'effectScatter',
              coordinateSystem: 'geo',
              showEffectOn: 'render',
              zlevel: 1,
              rippleEffect: {
                period: 15,
                scale: 2,
                brushType: 'fill',
              },
              hoverAnimation: true,
              label: {
                normal: {
                  formatter: p => {
                    switch (p.name) {
                      case '内蒙古自治区':
                        p.name = '内蒙古';
                        break;
                      case '西藏自治区':
                        p.name = '西藏';
                        break;
                      case '新疆维吾尔自治区':
                        p.name = '新疆';
                        break;
                      case '宁夏回族自治区':
                        p.name = '宁夏';
                        break;
                      case '广西壮族自治区':
                        p.name = '广西';
                        break;
                      case '香港特别行政区':
                        p.name = '香港';
                        break;
                      case '澳门特别行政区':
                        p.name = '澳门';
                        break;
                      default:
                        break;
                    }
                    return p.name;
                  },
                  position: 'center',
                  offset: [10, 10],
                  //省份标题颜色
                  color: '#47ccd4',
                  //是否展示线的省份
                  // show: true,
                },
              },
              itemStyle: {
                normal: {
                  color: '#1DE9B6',
                  shadowBlur: 5,
                  shadowColor: '#333',
                },
              },
              symbolSize: 12,
              data: item[1].map(function(dataItem) {
                //
                return {
                  name: dataItem[1].name,
                  itemStyle: { color: dataItem[1].lineStyle },
                  value: geoCoordsMap[dataItem[1].name].concat([dataItem[1].value]),
                };
              }),
            }
          );
        });
        resolve(series);
      });
    },
    async startIonMap(proviceName, cityCodeArr) {
      let cityCode;
      let MapData = {};
      MapData.data = [];
      let arr;
      if (cityCodeArr && cityCodeArr.length !== 0 && Array.isArray(cityCodeArr)) {
        if (cityCodeArr.length === 1) {
          cityCode = cityCodeArr[0].toString();
          arr = require(`../../../static/public/map/download/${cityCode}.json`);
        }
      } else if (activeInstance.key === 'china') {
        cityCode = 'china';
        arr = require('../../../static/public/map/china.json');
      } else {
        cityCode = activeInstance.key.toString();
        arr = require(`../../../static/public/map/download/${cityCode}.json`);
      }
      MapData.data = arr;
      if (activeInstance.name === proviceName) {
        let radnow = Math.round(Math.random() * Math.abs(arr.length - 1));
        const rowName = arr.filter((item, index) => index === radnow);
        proviceName = rowName[0].properties.name;
        that.cityName = proviceName;
      }
      const { cityPick: shuzuN = [], geoCoordsMap: geoCoordsMaps = {} } = that.cityListCofig(proviceName, arr);
      if (MapData.data.length > 0) {
        that.geoJson.features = MapData.data;
      } else if (MapData.data.length === 0) {
        that.geoJson.features = that.geoJson.features.filter(item => item.properties.adcode == adcode);
        if (that.geoJson.features.length === 0) return;
      }
      const mapData = that.getMapData();
      //EBD
      that.$echarts.registerMap(cityCode, that.geoJson);
      const newSeres = await that.randomConfiguration(proviceName, shuzuN, mapData, cityCode, geoCoordsMaps);
      let option = {
        roam: false,
        geo: {
          map: cityCode,
          aspectScale: 0.75, //长宽比
          zoom: 1.1,
          roam: false,
          zlevel: 0,
          itemStyle: {
            normal: {
              opacity: '0.8',
              borderColor: 'borderColor',
              borderWidth: 3,
              shadowColor: 'borderColor',
              shadowOffsetX: 4,
              shadowOffsetY: 8,
            },
            emphasis: {
              areaColor: '#2AB8FF',
              borderWidth: 0,
              color: 'green',
              label: {
                show: false,
              },
            },
          },
          regions: [
            {
              name: '南海诸岛',
              itemStyle: {
                areaColor: 'rgba(0, 10, 52, 1)',
                borderColor: 'rgba(0, 10, 52, 1)',
                normal: {
                  opacity: 0,
                  label: {
                    show: false,
                    color: '#009cc9',
                  },
                },
              },
            },
          ],
        },
        series: newSeres,
      };
      return option;
    },
    convertData(data, geoCoordsMap) {
      var res = [];
      for (var i = 0; i < data.length; i++) {
        var dataItem = data[i];
        var fromCoord = geoCoordsMap[dataItem[0].name];
        var toCoord = geoCoordsMap[dataItem[1].name];
        var lineStyle = dataItem[1].lineStyle;
        if (fromCoord && toCoord) {
          res.push([
            { coord: fromCoord, lineStyle: { color: lineStyle } },
            { coord: toCoord, lineStyle: { color: lineStyle } },
          ]);
        }
      }
      return res;
    },
    getMapData() {
      //对应处理的返回的地图的号
      let mapData = this.geoJson.features.map(item => {
        return {
          name: item.properties.name,
          value: Math.random() * 1000,
          cityCode: item.properties.adcode,
        };
      });
      mapData = mapData.sort(function(a, b) {
        return b.value - a.value;
      });
      return mapData;
    },
    async cityMapXs(items) {
      let NewArray = [];
      let MapArray = [];
      let zhixiao = '';
      that.mapList.find((item, index) => {
        NewArray.push(item);
        if (item.key === items.key) {
          zhixiao = items.key;
          return true;
        }
      });
      if (that.mapList.length === NewArray.length) {
        return false;
      }
      that.cityCodeArr.find((item, index) => {
        MapArray.push(item);
        if (items.key === 'china') {
          MapArray = [];
          return true;
        }
        if (item === items.key) {
          return true;
        }
      });
      that.cityCodeArr = MapArray;
      that.mapList = NewArray;
      // that.myChart.clear();
      let cityName;
      that.clearTimer();
      that.mapShow = true;
      setTimeout(() => {
        cityName = that.mapList[that.mapList.length - 1].name;
        that.pack = cityName === '全国' ? '' : cityName;
        let pick = { name: cityName, key: that.mapList[that.mapList.length - 1].key };
        that.setActiveInstance(pick)(pick);
        that.mapShow = false;
        that.cityName = cityName === '全国' ? '浙江省' : cityName;
        that.runMapOption(cityName === '全国' ? '浙江省' : cityName, zhixiao === 'china' ? 'china' : [zhixiao]);
      }, 1800);
    },
    setActiveInstance(now, update = false) {
      if (update) {
        prevActiveInstance = now;
      } else {
        prevActiveInstance = activeInstance;
        activeInstance = now;
      }
      return key => {
        if (key) {
          prevActiveInstance = key;
        }
        activeInstance = prevActiveInstance;
      };
    },
    async runMapOption(cityName, cityCodeArr) {
      //跑配置
      // setTimeout(async () => {
      //
      if (that.myChart.getOption()) {
        //
        that.myChart.clear();
        //
      }
      // //console.log(that.myChart)
      //
      const MapOptions = await that.startIonMap(cityName, cityCodeArr);
      if (MapOptions && typeof MapOptions === 'object') {
        //
        // //console.log(that.myChart.getOption())
        //
        that.myChart.setOption(MapOptions, true);
        //console.log(that.myChart)
      }
      // }, 200);
    },
    cityListCofig(proviceName, nowCityArray) {
      let CityProvincesArray = []; //获取provincesText 116.4551,39.8539
      nowCityArray.map(item => {
        CityProvincesArray.push({ name: item.properties.name, center: item.properties.center });
      });
      let TextCtiy = CityProvincesArray.filter(item => item.name !== proviceName);
      let NowCtiy = CityProvincesArray.filter(item => item.name === proviceName);
      const cityPick = that.flyLineRandom(proviceName, TextCtiy, NowCtiy);
      const geoCoordsMap = that.geoCoordsMapRandom(cityPick);
      return { cityPick, geoCoordsMap };
    },
    flyLineRandom(proviceName, nowCityArray, NowCtiy) {
      let shuzu = []; //飞线到要的位置
      let shuzuN = [];
      let color = ['#52b9c7', '#5abead', '#f34e2b', '#f56f1c', '#f56321'];
      let TextCtiy = nowCityArray;
      let provincesTextPush;
      let newMap = new Map();
      let indexList = -1;
      while (++indexList < TextCtiy.length) {
        let random = Math.floor(Math.random() * TextCtiy.length).toString();
        if (newMap.get(random)) {
          --indexList;
        } else {
          newMap.set(random, random);
        }
      }
      provincesTextPush = Array.from([...newMap.values()]);
      let nums = 0;
      provincesTextPush.length >= 4 ? (nums = 4) : (nums = provincesTextPush.length);
      //console.log(provincesTextPush, 'xxx');
      for (let index = 0; index < nums; index++) {
        shuzu.push(
          { name: proviceName },
          {
            name: TextCtiy[provincesTextPush[index]].name,
            value: 8,
            lineStyle: color[index],
            center: TextCtiy[provincesTextPush[index]].center,
          }
        );
        if (shuzu.length == 2) {
          let pick = [];
          while (shuzu.length) {
            let max = shuzu.shift();
            pick.push(max);
          }
          shuzuN.push(pick);
        }
      }
      //
      shuzu.push(
        { name: NowCtiy[0].name },
        {
          name: NowCtiy[0].name,
          value: 8,
          lineStyle: '#5abead',
          center: NowCtiy[0].center,
        }
      );
      shuzuN.push(shuzu);
      return shuzuN;
    },
    geoCoordsMapRandom(cityPick) {
      let map = {};
      for (const key in cityPick) {
        map[cityPick[key][1].name] = cityPick[key][1].center;
      }
      return map;
    },
    //END JY TIME 2021-5/27
  },
};
</script>
<style lang="less" scoped>
.isopacity {
  opacity: 1 !important;
}
.textani {
  transition: 2s all;
  right: 1.33rem !important;
  opacity: 1 !important;
}
.textani1 {
  transition: 2s all;
  right: 1.03rem !important;
  opacity: 1 !important;
}
.widthto100 {
  transition: 2s all;
  width: 0.26rem !important;
}
.widthto99 {
  transition: 2s all;
  width: 1.2rem !important;
}
.widthto98 {
  transition: 2s all;
  width: 2.8rem !important;
}
.widthto97 {
  transition: 2s all;
  width: 0.26rem !important;
}
.noshow {
  display: none;
}
.show {
  display: block !important;
}
.nihaox {
  margin: 0.6rem 0.15rem;
  .tdsx {
    cursor: pointer;
    margin: 0;
    font-size: 0.25rem;
    color: #26cfff;
  }
  .icon {
    font-family: 'simsun';
    font-size: 0.25rem;
    margin: 0 0.02rem;
    color: pink;
  }
}
@keyframes xian1 {
  from {
    width: 0;
    left: 1.6rem;
    top: 1.13rem;
    transform: rotate(-50deg);
    opacity: 0;
  }
}
@keyframes xian2 {
  from {
    width: 0;
    left: 1.62rem;
    top: 1.07rem;
    transform: rotate(-75deg);
    opacity: 0;
  }
}
@keyframes xian3 {
  from {
    width: 0;
    left: 1.51rem;
    top: 1.21rem;
    transform: rotate(-35deg);
    opacity: 0;
  }
}
@keyframes xian4 {
  from {
    width: 0;
    left: 1.55rem;
    top: 1.25rem;
    transform: rotate(-62deg);
    opacity: 0;
  }
}
.xian1Animation {
  animation: xian1 1s linear 0s 1;
  display: block !important;
}
.xian2Animation {
  animation: xian2 1s linear 0s 1;
  display: block !important;
}
.xian3Animation {
  animation: xian3 1s linear 0s 1;
  display: block !important;
}
.xian4Animation {
  animation: xian4 1s linear 0s 1;
  display: block !important;
}
.tob {
  margin-top: 3.62rem;
}
.map-wrap {
  width: 100%;
  height: 100%;
  position: fixed;
  left: 0;
  top: 0;
  background-image: url('../../assets/images/map-bg.png');
  background-size: 100% 100%;
  background-repeat: no-repeat;
  .tableWrap {
    position: relative;
    top: -0.9rem;
    right: 0.55rem;
    display: flex;
    flex-direction: column;
    .pie-box {
      transition: 2s all;
      opacity: 0;
      z-index: 16;
      width: 2.8rem;
      height: 3.42rem;
      position: absolute;
      top: 0;
      right: 0;
      border: 0.01rem solid #002c46;
      .header-tab {
        width: 100%;
        display: flex;
        .top {
          font-size: 0.16rem;
          text-align: center;
          flex: 1;
          color: #004758;
          height: 0.3rem;
          line-height: 0.3rem;
          border-right: 0.01rem solid #002c46;
          box-sizing: border-box;
          font-weight: bold;
          cursor: pointer;
          z-index: 666;
        }
        .topstyle {
          border: 0.01rem solid #00b5e3;
          color: #00b5e3;
          border-bottom: none;
          background-size: 100% 100%;
          background-image: url('../../assets/images/map-pie-top.png');
        }
      }
      .circle-bg {
        width: 2.78rem;
        height: 2.35rem;
        // background-color: pink;
        border: 0.01rem solid #00b5e3;
        background-size: 100% 100%;
        background-image: url('../../assets/images/map-piebg.png');
        box-sizing: border-box;
        .circle {
          z-index: 999;
          width: 278px;
          height: 235px;
        }
      }
      .pie-bg2 {
        height: 0.25rem;
        line-height: 0.25rem;
        width: 100%;
        background-size: 100% 100%;
        background-image: url('../../assets/images/map-piebg2.png');
        box-sizing: border-box;
        font-size: 0.14rem;
        color: #f3c800;
        padding-left: 0.1rem;
        border: 0.01rem solid #00b5e3;
      }
      .pie-bg3 {
        height: 0.5rem;
        line-height: 0.5rem;
        width: 100%;
        background-size: 100% 100%;
        background-image: url('../../assets/images/map-piebg3.png');
        box-sizing: border-box;
        font-size: 0.18rem;
        color: #f3c800;
        border: 0.01rem solid #00b5e3;
        text-align: center;
      }
    }
    .pie-box2 {
      transition: 2s all;
      opacity: 0;
      z-index: 16;
      margin-top: 3.55rem;
      width: 2.8rem;
      height: 2.82rem;
      position: absolute;
      top: 0;
      right: 0;
      border: 0.01rem solid #002c46;
      .header-tab {
        width: 100%;
        display: flex;
        .top {
          font-size: 0.18rem;
          text-align: center;
          flex: 1;
          color: #004758;
          height: 0.3rem;
          line-height: 0.3rem;
          border-right: 0.01rem solid #002c46;
          box-sizing: border-box;
          font-weight: bold;
          z-index: 666;
          cursor: pointer;
        }
        .topstyle {
          border: 0.01rem solid #00b5e3;
          color: #00b5e3;
          border-bottom: none;
          background-size: 100% 100%;
          background-image: url('../../assets/images/map-pie-top.png');
        }
      }
      .circle-bg {
        z-index: 998;
        width: 100%;
        height: 2.5rem;
        border: 0.01rem solid #00b5e3;
        background-size: 100% 100%;
        background-image: url('../../assets/images/map-piebg.png');
        box-sizing: border-box;
        .circle2 {
          z-index: 999;
          width: 2.78rem;
          height: 2.5rem;
        }
      }
    }
    .histogram-week {
      transition: 2s all;
      opacity: 0;
      z-index: 16;
      margin-top: 6.55rem;
      width: 2.8rem;
      height: 2.3rem;
      position: absolute;
      top: 0;
      right: 0;
      border: 0.01rem solid #002c46;
      .header-tab {
        width: 100%;
        display: flex;
        cursor: pointer;
        z-index: 666;
        .top {
          font-size: 0.16rem;
          text-align: center;
          flex: 1;
          color: #004758;
          height: 0.4rem;
          line-height: 0.4rem;
          border-right: 0.01rem solid #002c46;
          box-sizing: border-box;
          font-weight: bold;
        }
        .topstyle {
          border: 0.01rem solid #00b5e3;
          color: #00b5e3;
          border-bottom: none;
          background-size: 100% 100%;
          background-image: url('../../assets/images/map-pie-top.png');
        }
      }
      .histogram-bg {
        width: 100%;
        height: 1.97rem;
        border: 0.01rem solid #00b5e3;
        background-size: 100% 100%;
        background-image: url('../../assets/images/map-piebg.png');
        box-sizing: border-box;
        .histogram {
          width: 2.78rem;
          height: 1.97rem;
        }
      }
    }
    // 会员数
    .vip-box {
      z-index: 16;
      width: 3.5rem;
      height: 0.65rem;
      /*background: red;*/
      top: 2.15rem;
      left: 12rem;
      position: absolute;
      // background-color: pink;
      .o-yuan {
        position: absolute;
        right: -0.48rem;
        top: -0.3rem;
      }
      .c-yuan {
        position: absolute;
        right: -0.36rem;
        top: -0.42rem;
      }
      .n-yuan {
        position: absolute;
        right: -0.29rem;
        top: -0.49rem;
      }
      .tb-logo {
        width: 0.26rem;
        height: 0.26rem;
        position: absolute;
        right: -0.18rem;
        top: 0.2rem;
        img {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        }
        /*background: red;*/
      }
      .cz-png {
        width: 0rem;
        height: 0.06rem;
        /*display: block;*/
        position: absolute;
        top: 0.04rem;
        right: 0.3rem;
        /*animation: vip-cz 1s linear 0s 1;*/
      }
      .p-xian {
        width: 0rem;
        height: 0.24rem;
        /*display: block;*/
        position: absolute;
        bottom: 0rem;
        right: 0.25rem;
        /*animation: vip-xian 1s linear 0s 1;*/
      }
      .vip-number {
        display: none;
        font-size: 0.19rem;
        color: #f3c800;
        position: absolute;
        font-weight: bold;
        top: -0.08rem;
        right: 1.55rem;
      }
      .vip-tit {
        transition: 2s all;
        opacity: 0;
        position: absolute;
        top: 0.13rem;
        right: 2.33rem;
        p {
          font-size: 0.15rem;
          color: #007387;
          text-align: center;
        }
        .p1 {
          font-size: 0.15rem;
          color: #00ddf7;
          font-weight: bold;
        }
      }
    }
    // 消费订单
    .consume-box {
      z-index: 16;
      width: 3.5rem;
      height: 0.65rem;
      /*background: red;*/
      top: 1rem;
      left: 11rem;
      position: absolute;
      // background-color: pink;
      .o-yuan {
        position: absolute;
        right: -0.48rem;
        top: -0.3rem;
      }
      .c-yuan {
        position: absolute;
        right: -0.36rem;
        top: -0.42rem;
      }
      .n-yuan {
        position: absolute;
        right: -0.29rem;
        top: -0.49rem;
      }
      .tb-logo {
        width: 0.26rem;
        height: 0.26rem;
        position: absolute;
        right: -0.17rem;
        top: 0.2rem;
        img {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        }
        /*background: red;*/
      }
      .cz-png {
        width: 0rem;
        height: 0.06rem;
        /*display: block;*/
        position: absolute;
        top: 0.04rem;
        right: 0.3rem;
        /*animation: vip-cz 1s linear 0s 1;*/
      }
      .p-xian {
        width: 0rem;
        height: 0.24rem;
        /*display: block;*/
        position: absolute;
        bottom: 0rem;
        right: 0.25rem;
        /*animation: vip-xian 1s linear 0s 1;*/
      }
      .vip-number {
        display: none;
        font-size: 0.19rem;
        color: #f3c800;
        position: absolute;
        font-weight: bold;
        top: -0.08rem;
        right: 1.55rem;
      }
      .vip-tit {
        transition: 2s all;
        opacity: 0;
        position: absolute;
        top: 0.13rem;
        right: 2.33rem;
        p {
          font-size: 0.15rem;
          color: #007387;
          text-align: center;
        }
        .p1 {
          font-size: 0.15rem;
          color: #00ddf7;
          font-weight: bold;
        }
      }
    }
    //订单交易额
    .Order-volume {
      z-index: 16;
      width: 3.5rem;
      height: 0.65rem;
      /*background: red;*/
      top: 7.2rem;
      left: 4rem;
      position: absolute;
      .bo-yuan {
        position: absolute;
        left: -0.31rem;
        top: -0.28rem;
      }
      .bc-yuan {
        position: absolute;
        left: -0.18rem;
        top: -0.39rem;
      }
      .bn-yuan {
        position: absolute;
        left: -0.1rem;
        top: -0.46rem;
      }
      .tb-logo {
        width: 0.26rem;
        height: 0.26rem;
        position: absolute;
        left: 0.02rem;
        top: 0.22rem;
        img {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        }
        /*background: red;*/
      }
      .cz-png {
        width: 0rem;
        height: 0.06rem;
        /*display: block;*/
        position: absolute;
        top: 0.04rem;
        left: 0.46rem;
        /*animation: vip-cz 1s linear 0s 1;*/
      }
      .p-xian {
        width: 0rem;
        height: 0.24rem;
        /*display: block;*/
        position: absolute;
        bottom: 0;
        left: 0.46rem;
        /*animation: vip-xian 1s linear 0s 1;*/
      }
      .vip-number {
        display: none;
        font-size: 0.19rem;
        color: #f3c800;
        position: absolute;
        font-weight: bold;
        top: -0.08rem;
        right: 0.8rem;
      }
      .vip-tit {
        transition: 2s all;
        opacity: 0;
        position: absolute;
        top: 0.13rem;
        right: 2.03rem;
        p {
          font-size: 0.15rem;
          color: #007387;
          text-align: center;
        }
        .p1 {
          font-size: 0.15rem;
          color: #00ddf7;
          font-weight: bold;
        }
      }
    }
    // 地区收益
    .region-box {
      z-index: 16;
      width: 3.5rem;
      height: 0.65rem;
      /*background: red;*/
      top: 8.3rem;
      left: 6.1rem;
      position: absolute;
      .bo-yuan {
        position: absolute;
        left: -0.31rem;
        top: -0.28rem;
      }
      .bc-yuan {
        position: absolute;
        left: -0.18rem;
        top: -0.39rem;
      }
      .bn-yuan {
        position: absolute;
        left: -0.1rem;
        top: -0.46rem;
      }
      .tb-logo {
        width: 0.26rem;
        height: 0.26rem;
        position: absolute;
        left: 0.02rem;
        top: 0.22rem;
        img {
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        }
        /*background: red;*/
      }
      .cz-png {
        width: 0rem;
        height: 0.06rem;
        /*display: block;*/
        position: absolute;
        top: 0.04rem;
        left: 0.46rem;
        /*animation: vip-cz 1s linear 0s 1;*/
      }
      .p-xian {
        width: 0rem;
        height: 0.24rem;
        /*display: block;*/
        position: absolute;
        bottom: 0;
        left: 0.46rem;
        /*animation: vip-xian 1s linear 0s 1;*/
      }
      .vip-number {
        display: none;
        font-size: 0.19rem;
        color: #f3c800;
        position: absolute;
        font-weight: bold;
        top: -0.08rem;
        right: 0.8rem;
      }
      .vip-tit {
        transition: 2s all;
        opacity: 0;
        position: absolute;
        top: 0.13rem;
        right: 2.03rem;
        p {
          font-size: 0.15rem;
          color: #007387;
          text-align: center;
        }
        .p1 {
          font-size: 0.15rem;
          color: #00ddf7;
          font-weight: bold;
        }
      }
    }
  }
  .logo {
    left: 0.15rem;
    top: 0.15rem;
    width: 4rem;
    height: 0.8rem;
    background-image: url('../../assets/images/map-logo.png');
    background-repeat: no-repeat;
    background-size: auto 100%;
    position: absolute;
  }
  .time {
    width: 5rem;
    height: 0.8rem;
    background-image: url('../../assets/images/map-time.png');
    background-repeat: no-repeat;
    background-size: auto 100%;
    position: absolute;
    right: 0.15rem;
    top: 0.15rem;
    .tt {
      font-size: 0.23rem;
      position: absolute;
      height: 0.8rem;
      line-height: 0.8rem;
      left: 0.25rem;
      color: #68efff;
    }
    .day {
      font-size: 0.15rem;
      position: absolute;
      height: 0.8rem;
      line-height: 0.8rem;
      left: 0.3rem;
      color: #007285;
      .rz {
        width: 1rem;
        font-size: 0.23rem;
        position: absolute;
        height: 0.8rem;
        line-height: 0.8rem;
        left: 1.15rem;
        color: #007285;
      }
      .year {
        width: 1rem;
        font-size: 0.23rem;
        position: absolute;
        height: 0.8rem;
        line-height: 0.8rem;
        left: 2.05rem;
        color: #007285;
      }
    }
    .city {
      width: 1rem;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      font-size: 0.25rem;
      position: absolute;
      height: 0.8rem;
      line-height: 0.8rem;
      left: 3.2rem;
      color: #007285;
      // background-color: pink;
    }
  }
  .chanzhe {
    transition: 1s all;
    opacity: 1 !important;
    transform: scale(1) !important;
  }
  .xian1change {
    width: 2.26rem;
    transform: rotate(-50deg);
  }
  .citywraper {
    .mask {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
    .mask1 {
      display: none;
      width: 100%;
      height: 100%;
      // background-color: hotpink;
    }
    transform: scale(0);
    opacity: 0;
    position: relative;
    top: 42%;
    left: 48.5%;
    width: 3.35rem;
    height: 2.08rem;
    background-image: url('../../assets/images/map-k.png');
    background-repeat: no-repeat;
    .cityName {
      // background-color: pink;
      width: 0.6rem;
      text-overflow: ellipsis;
      overflow: hidden;
      white-space: nowrap;
      position: absolute;
      top: 0.09rem;
      left: 0.2rem;
      color: #00d6f0;
      font-size: 0.15rem;
      font-weight: 600;
    }
    .quyu {
      width: 100%;
      height: 100%;
      text-align: center;
      .imgPosition {
        width: 1.24rem;
        height: 1.54rem;
        z-index: 999999;
        margin-top: 0.4rem;
      }
      .Dot {
        &::before {
          content: '';
          width: 0.2rem;
          height: 0.2rem;
          background-color: #f3c800;
          border-radius: 50%;
          position: absolute;
          top: 1.09rem;
          left: 1.54rem;
          z-index: 2;
        }
        &::after {
          content: '';
          position: absolute;
          background-color: #f3c800;
          border-radius: 50%;
          z-index: 1;
          animation: mymove 1s infinite;
          -webkit-animation: mymove 1s infinite;
        }
        @keyframes mymove {
          from {
            width: 0;
            height: 0;
            opacity: 1;
            top: 1.15rem;
            left: 1.6rem;
          }
          to {
            width: 0.6rem;
            height: 0.6rem;
            opacity: 0;
            top: 0.9rem;
            left: 1.35rem;
          }
        }
      }
      .xian1 {
        width: 2.26rem;
        border-top: 0.03rem solid rgba(243, 200, 0, 0.5);
        height: 0rem;
        // background-color: rgba(243, 200, 0, 0.5);
        position: absolute;
        left: 1.3rem;
        top: 0.24rem;
        transform: rotate(-50deg);
        opacity: 1;
      }
      .xian2 {
        width: 2.98rem;
        border-top: 0.03rem solid rgba(243, 200, 0, 0.5);
        height: 0rem;
        // background-color: rgba(243, 200, 0, 0.5);
        position: absolute;
        left: 0.54rem;
        top: -0.33rem;
        transform: rotate(-75deg);
        opacity: 1;
      }
      .xian3 {
        z-index: 17;
        width: 5.17rem;
        border-top: 0.03rem solid rgba(243, 200, 0, 0.5);
        height: 0;
        // background-color: rgba(243, 200, 0, 0.5);
        position: absolute;
        left: -3.13rem;
        top: 2.68rem;
        transform: rotate(-35deg);
        opacity: 1;
      }
      .xian4 {
        z-index: 17;
        width: 4.64rem;
        border-top: 0.03rem solid rgba(243, 200, 0, 0.5);
        height: 0;
        // background-color: rgba(243, 200, 0, 0.5);
        position: absolute;
        left: -1.73rem;
        top: 3.13rem;
        transform: rotate(-62deg);
        opacity: 1;
      }
    }
  }
}
.map-wrap .province .quyu img {
  height: 100%;
  display: block;
  margin: 0 auto;
}
.map-wrap #city {
  width: 1000px;
  height: 1000px;
  /* background: #1B1B1B; */
  position: absolute;
  left: 0.06rem;
  top: -0.72rem;
  z-index: 0;
}
.showMap {
  opacity: 0 !important;
  transition: all 0.7s !important;
  transform: scale(0) !important;
}
.showMapNot {
  opacity: 1;
  transition: all 0.8s;
}
</style>
